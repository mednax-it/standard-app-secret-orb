description: >
  This command will capture the incoming variables, clone the git repo, and execute the run
# What will this command do?
# Descriptions should be short, simple, and clear.
parameters:
  app_registration_id:
    type: string
    description: "Application registration client id"
  resource_group_name:
    type: string
    description: "Resource group where the key vault resides"
  key_vault_name:
    type: string
    description: "Unique name of the key vault where the secret will be stored"
  key_name:
    type: string
    description: "Unique name of the key which will house the secret as a value"

steps:
  - clone:
      name: Clone Terraform
      command: git clone git@github.com:mednax-it/standard-app-secret-generation.git
  - run:
      environment:
        app_registration_id: <<parameters.app_registration_id>>
        resource_group_name: <<parameters.resource_group_name>>
        key_vault_name: <<parameters.key_vault_name>>
        key_name: <<parameters.key_name>>
      name: Generate secret
      command: <<include(scripts/apply.sh)>>
